{
  "name": "BPIC14",
  "version": "1.0.0",
  "nodes": [
    {
      "include": true,
      "type": "Event",
      "constructor": [
        {
          "prevalent_record": "(record:EventRecord)",
          "result": "(e:Event {timestamp:record.timestamp, activity:record.activity})"
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(e:Event:IncidentEvent {timestamp:record.openTime, activity = \"Open Incident\"})"
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(e:Event:IncidentEvent {timestamp:record.reopenTime, activity = \"Reopen Incident\"})"
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(e:Event:IncidentEvent {timestamp:record.closeTime, activity = \"Close Incident\"})"
        }
      ]
    },
    {
      "include": true,
      "type": "Activity",
      "constructor": [
        {
          "prevalent_record": "(record:EventRecord)",
          "result": "(a:Activity {activity:record.activity})",
          "infer_observed": true
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(a:Activity {activity: \"Open Incident\"})",
          "infer_observed": true
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(a:Activity {activity: \"Reopen Incident\"})",
          "infer_observed": true
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(a:Activity {activity: \"Close Incident\"})",
          "infer_observed": true
        }
      ]
    },
    {
      "include": true,
      "type": "ConfigurationItem",
      "constructor": [
        {
          "prevalent_record": "(record:ACIRecord)",
          "result": "(ci:Entity:ConfigurationItem {sysId: record.ciNameAff})",
          "set_properties": "ci.type = record.ciTypeAff, ci.subType = record.ciSubtypeAff"
        },
        {
          "prevalent_record": "(record:CBCIRecord)",
          "result": "(ci:Entity:ConfigurationItem {sysId: record.ciNameCBy})",
          "set_properties": "ci.type = record.ciTypeCBy, ci.subType = record.ciSubtypeCBy"
        }
      ]
    },
    {
      "include": true,
      "type": "ServiceComponent",
      "constructor": [
        {
          "prevalent_record": "(record:ACIRecord)",
          "result": "(sc:Entity:ServiceComponent {sysId: record.serviceComponentAff})"
        },
        {
          "prevalent_record": "(record:CBCIRecord)",
          "result": "(sc:Entity:ServiceComponent {sysId: record.serviceComponentCBy})"
        }
      ]
    },
    {
      "include": true,
      "type": "Incident",
      "constructor": [
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(i:Entity:Incident {sysId: record.incidentId})",
          "set_properties": "i.category = record.category, i.openTime = record.openTime, i.reopenTime = record.reopenTime, i.closeTime = record.closeTime, i.resolvedTime = record.resolvedTime, i.status = record.status, i.alertStatus = record.alertStatus, i.impact = record.impact, i.urgency = record.urgency, i.priority = record.priority, i.numReassignments = record.numReassignments, i.handleTimeHours = record.handleTimeHours, i.closureCode = record.closureCode",
          "infer_corr_from_entity_record": true,
          "event_label": "IncidentEvent"
        },
        {
          "prevalent_record": "(record:EventRecord)",
          "result": "(i:Entity:Incident {sysId: record.incidentId})",
          "infer_corr_from_event_record": true
        }
      ],
      "infer_df": true,
      "include_label_in_df": true,
      "merge_duplicate_df": true
    },
    {
      "include": true,
      "type": "Interaction",
      "constructor": [
        {
          "prevalent_record": "(record:InteractionRecord)",
          "result": "(it:Entity:Interaction {sysId: record.interactionId})",
          "set_properties": "it.impact = record.impact, it.urgency = record.urgency, it.priority = record.priority, it.status = record.status, it.firstCallResolution = record.firstCallResolution, it.category = record.category, it.openTime = record.openTime, it.closeTime = record.closeTime, it.handleTimeSecs = record.handleTimeSecs, it.closureCode = record.closureCode"
        },
        {
          "prevalent_record": "(record:EventRecord)",
          "result": "(it:Entity:Interaction {sysId: record.interactionId})",
          "infer_corr_from_event_record": true
        }
      ],
      "include_label_in_df": true,
      "merge_duplicate_df": true
    },
    {
      "include": true,
      "type": "Change",
      "constructor": [
        {
          "prevalent_record": "(record: ChangeRecord)",
          "result": "(c:Entity:Change {sysId: record.changeId})",
          "set_properties": "c.type = record.changeType, c.riskAssessment = record.riskAssessment, c.emergencyChange = record.emergencyChange, c.cabApprovalNeeded = record.cabApprovalNeeded, c.plannedStart = record.plannedStart, c.requestedEndDate = record.requestedEndDate, c.changeRecordOpenTime = record.changeRecordOpenTime, c.changeRecordCloseTime = record.changeRecordCloseTime, c.originatedFrom = record.originatedFrom, c.plannedEnd: record.plannedEnd, c.scheduledDowntimeStart: record.scheduledDowntimeStart, c.scheduledDowntimeEnd: record.scheduledDowntimeEnd, c.actualStart: record.actualEnd, c.numRelatedIncidents: record.numRelatedIncidents, c.numRelatedInteractions: record.numRelatedInteractions"
        },
        {
          "prevalent_record": "(record:IncidentRecord)",
          "result": "(c:Entity:Change {sysId: record.relatedChange})"
        }
      ]
    },
    {
      "include": true,
      "type": "Resource",
      "constructor": [
        {
          "prevalent_record": "(record:EventRecord)",
          "result": "(res:Entity:Resource {sysId: record.assignmentGroup})",
          "infer_corr_from_event_record": true
        }
      ],
      "infer_df": true,
      "include_label_in_df": true,
      "merge_duplicate_df": true
    },
    {
      "include": true,
      "type": "KnowledgeDocument",
      "constructor": [
        {
          "prevalent_record": "(record:KMRecord)",
          "result": "(km:Entity:KnowledgeDocument {sysId: record.kmNumber})",
          "infer_corr_from_event_record": false
        }
      ]
    }
  ],
  "relations": [
    {
      "type": "RELATED_CHANGE",
      "constructor": {
        "prevalent_record": "(:IncidentRecord {incidentId: i.sysId, relatedChange: c.sysId})",
        "from_node": "(i:Incident)",
        "to_node": "(c:Change)",
        "result": "(i) - [:RELATED_CHANGE] -> (c)"
      }
    },
    {
      "type": "CAUSED_BY",
      "constructor": {
        "prevalent_record": "(:IncidentRecord {incidentId: i.sysId, ciNameCBy: ci.sysId})",
        "from_node": "(i:Incident)",
        "to_node": "(ci:ConfigurationItem)",
        "result": "(i) - [:CAUSED_BY] -> (ci)"
      }
    },
    {
      "type": "AFFECTED_CI",
      "constructor": [
        {
          "prevalent_record": "(:IncidentRecord {incidentId: i.sysId, ciNameAff: ci.sysId})",
          "from_node": "(i:Incident)",
          "to_node": "(ci:ConfigurationItem)",
          "result": "(i) - [:AFFECTED_CI] -> (ci)"
        },
        {
          "prevalent_record": "(:InteractionRecord {interactionId: i.sysId, ciNameAff: ci.sysId})",
          "from_node": "(i:Interaction)",
          "to_node": "(ci:ConfigurationItem)",
          "result": "(i) - [:AFFECTED_CI] -> (ci)"
        }
      ]
    },
    {
      "type": "RelatedServiceComponent",
      "constructor": [
        {
          "prevalent_record": "(:ACIRecord {ciNameAff: ci.sysId, serviceComponentAff: sc.sysId})",
          "from_node": "(ci:ConfigurationItem)",
          "to_node": "(sc:ServiceComponent)",
          "result": "(ci) - [:RELATED_SERVICE_COMPONENT] -> (sc)"
        },
        {
          "prevalent_record": "(:CBCIRecord {ciNameCBy: ci.sysId, serviceComponentCBy: sc.sysId})",
          "from_node": "(ci:ConfigurationItem)",
          "to_node": "(sc:ServiceComponent)",
          "result": "(ci) - [:RELATED_SERVICE_COMPONENT] -> (sc)"
        }
      ]
    },
    {
      "type": "ChangedBy",
      "constructor": {
        "prevalent_record": "(:ChangeRecord {changeId:c.sysId, ciNameAff: ci.sysId})",
        "from_node": "(ci:ConfigurationItem)",
        "to_node": "(c:Change)",
        "result": "(ci) - [:CHANGED_BY] -> (c)"
      }
    },
    {
      "type": "UsedKM",
      "constructor": [
        {
          "prevalent_record": "(:InteractionRecord {interactionId: i.sysId, kmNumber: kd.sysId})",
          "from_node": "(i:Interaction)",
          "to_node": "(kd:KnowledgeDocument)",
          "result": "(i) - [:USED_KM] -> (kd)"
        },
        {
          "prevalent_record": "(:IncidentRecord {incidentId: i.sysId, kmNumber: kd.sysId})",
          "from_node": "(i:Incident)",
          "to_node": "(kd:KnowledgeDocument)",
          "result": "(i) - [:USED_KM] -> (kd)"
        }
      ]
    },
    {
      "type": "RELATED_INTERACTION",
      "constructor": {
        "prevalent_record": "(:IncidentRecord {incidentId: id.sysId, relatedInteraction: it.sysId})",
        "from_node": "(id:Incident)",
        "to_node": "(it:Interaction)",
        "result": "(id) - [:RELATED_INTERACTION] -> (it)"
      }
    }
  ]
}